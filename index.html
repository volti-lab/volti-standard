<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volti Standard - í†µí•© ì „ë¬¸ê°€ í”Œë«í¼</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        :root { --primary: #0070f3; --dark: #111; --green: #00ff00; --accent: #ff4d4d; --corporate: #004a99; }
        body { font-family: 'Inter', sans-serif; background: #f0f2f5; margin: 0; color: #333; }
        
        /* 1. ì‹¤ì‹œê°„ ê¸€ë¡œë²Œ ì‹œì„¸ í‹°ì»¤ */
        .vix-ticker { background: var(--dark); color: var(--green); padding: 12px 0; overflow: hidden; white-space: nowrap; font-family: monospace; position: sticky; top: 0; z-index: 1000; }
        .ticker-content { display: inline-block; animation: ticker 40s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        header { padding: 30px; text-align: center; background: white; border-bottom: 1px solid #ddd; }
        .main-grid { display: grid; grid-template-columns: 1fr 1.2fr; gap: 25px; max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        
        .card { background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 20px; height: fit-content; }
        h2 { font-size: 1.25em; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px; margin-top: 0; }

        /* 2. í™•ì¥í˜• ì„¸ë¶„í™” ë©”ë‰´ (ì•„ì½”ë””ì–¸) */
        .menu-box { border: 1px solid #eee; border-radius: 8px; margin-top: 10px; }
        .menu-header { background: #f8f9fa; padding: 12px 15px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; font-size: 0.9em; }
        .menu-content { padding: 15px; display: none; background: white; border-top: 1px solid #eee; font-size: 0.85em; }
        .live-val { color: var(--accent); font-weight: bold; font-family: monospace; }

        /* 3. ì…ë ¥ í¼ ë° ë²„íŠ¼ */
        input, select, button { width: 100%; padding: 12px; margin: 8px 0; border-radius: 6px; border: 1px solid #ddd; box-sizing: border-box; }
        button { background: var(--primary); color: white; border: none; font-weight: bold; cursor: pointer; }
        .guide-box { background: #eef6ff; padding: 15px; border-radius: 8px; font-size: 0.9em; border-left: 4px solid var(--primary); }

        /* 4. ê¸°ì—… êµ¬ë§¤ ì„¹ì…˜ */
        .corporate-section { max-width: 1160px; margin: 40px auto; padding: 30px; background: white; border-radius: 16px; border: 2px solid var(--corporate); }
        .corp-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 20px; }
        .corp-item { padding: 15px; background: #f0f7ff; border-radius: 10px; text-align: center; font-size: 0.9em; }
    </style>
</head>
<body>

<div class="vix-ticker">
    <div class="ticker-content" id="live-ticker">
        [LIVE VIX KRW] ì„œìš¸: â‚©250.42 | ì œì£¼: â‚©292.15 | ë‰´ìš•: â‚©285.40 | ë² ë¥¼ë¦°: â‚©314.90 | ì‹¤ì‹œê°„ íƒ„ì†Œë°°ì¶œê¶Œ ì‹œì„¸ ë™ê¸°í™” ì¤‘...
    </div>
</div>

<header>
    <h1>Volti Standard Platform</h1>
    <p>ì—ë„ˆì§€ ê°€ì¹˜ ë¶„ì„ë¶€í„° ê¸°ì—…ìš© ESG í¬íŠ¸í´ë¦¬ì˜¤ê¹Œì§€ í†µí•© ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
</header>

<div class="main-grid">
    <div class="col">
        <div class="card">
            <h2>VT ê°€ì¹˜ ë¶„ì„ ì—”ì§„</h2>
            <input type="text" id="address" placeholder="ë°œì „ì†Œ ì£¼ì†Œ ê²€ìƒ‰" readonly onclick="findAddress()">
            <button onclick="findAddress()" style="background:#666;">ì£¼ì†Œ ì°¾ê¸°</button>
            <input type="number" id="kwh" placeholder="ë‹¹ì›” ë°œì „ëŸ‰ ì…ë ¥ (kWh)">
            
            <label style="font-size:12px; color:#666;">ì—ë„ˆì§€ ìƒì‚° ì‹œì  (ë…¸í›„ë„ í•„í„°)</label>
            <select id="months">
                <option value="1">ìµœê·¼ 1ê°œì›” ì´ë‚´ (ì‹ ê·œ ìƒì‚°)</option>
                <option value="6">6ê°œì›” ì´ë‚´</option>
                <option value="12">1ë…„ ì´ë‚´</option>
                <option value="24">2ë…„ ì´ìƒ (íš¨ìœ¨ ê°ê°€ ì ìš©)</option>
            </select>
            
            <button onclick="calculateVT()">ì‹¤ì‹œê°„ ê°€ì¹˜ ì •ë°€ ë¶„ì„</button>
            
            <div id="result" style="display:none; margin-top:20px;">
                <div class="guide-box">
                    <strong>ë¶„ì„ ê²°ê³¼: <span id="res-vt" style="font-size:1.3em;">0</span> VT</strong><br>
                    ì˜ˆìƒ í™˜ì‚° ìˆ˜ìµ: <span id="res-cash" style="color:var(--accent); font-weight:bold; font-size:1.3em;">0</span>ì›
                </div>
                <div id="analysis-log" style="font-size:11px; color:#777; margin-top:10px; padding:10px; background:#f9f9f9; border-radius:5px;">
                    </div>
            </div>
        </div>
    </div>

    <div class="col">
        <div class="card">
            <h2>ì‹¤ì‹œê°„ ë³€ë™ ì§€í‘œ (Live Factors)</h2>
            
            <div class="menu-box">
                <div class="menu-header" onclick="toggleMenu('m1')">
                    <span>ğŸ“Š ê³„í†µ ì†ì‹¤ ë° ì§€ì—­ ê°€ì¤‘ì¹˜ (L)</span>
                    <span id="m1-icon">+</span>
                </div>
                <div id="m1" class="menu-content">
                    â€¢ ì‹¤ì‹œê°„ ì†¡ì „ ì†ì‹¤ë¥ : <span class="live-val" id="val-loss">0.042%</span><br>
                    â€¢ ì„œìš¸/ë„ì‹¬ í”„ë¦¬ë¯¸ì—„: <span class="live-val">x1.25</span> ì ìš© ì¤‘
                </div>
            </div>

            <div class="menu-box">
                <div class="menu-header" onclick="toggleMenu('m2')">
                    <span>ğŸŒ ê¸€ë¡œë²Œ íƒ„ì†Œ ë° ì‹œì„¸ (C, Global)</span>
                    <span id="m2-icon">+</span>
                </div>
                <div id="m2" class="menu-content">
                    â€¢ EU íƒ„ì†Œë°°ì¶œê¶Œ(ETS): <span class="live-val" id="val-ets">â‚¬64.2</span><br>
                    â€¢ ë‰´ìš• REC ì‹œì„¸: <span class="live-val">$34.12</span><br>
                    â€¢ íƒ„ì†Œ ëŒ€ì²´ ê°€ì¤‘ì¹˜: <span class="live-val">x1.08</span>
                </div>
            </div>

            <div class="menu-box">
                <div class="menu-header" onclick="toggleMenu('m3')">
                    <span>ğŸ“… ê³„ì ˆë³„ í¬ì†Œì„± ê°€ì´ë“œ (R)</span>
                    <span id="m3-icon">+</span>
                </div>
                <div id="m3" class="menu-content">
                    â€¢ í˜„ì¬ ì‹œì¦Œ: <b>ë™ì ˆê¸°(Winter)</b><br>
                    â€¢ ê²¨ìš¸ ìƒì‚° ì „ë ¥ ê°€ì‚°ì : <span class="live-val">150% (í”„ë¦¬ë¯¸ì—„)</span><br>
                    â€¢ ê¸°ìƒ ë°ì´í„° ë°˜ì˜: <span class="live-val">ë§‘ìŒ (x1.1)</span>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="corporate-section">
    <h2 style="color:var(--corporate); text-align:center;">Enterprise B2B Buyer Guide</h2>
    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:30px; margin-top:20px;">
        <div class="guide-box" style="background:#fff;">
            <strong>ë§¤ì¶œì•¡ ê¸°ë°˜ êµ¬ë§¤ëŸ‰ ê³„ì‚°</strong><br>
            ê¸°ì—… ì—°ê°„ ë§¤ì¶œ(ì–µì›): <input type="number" id="corp-rev" placeholder="ì˜ˆ: 100" style="margin-top:5px;" oninput="calcCorp()">
            <div id="corp-res" style="margin-top:10px; font-weight:bold; color:var(--corporate);"></div>
        </div>
        <div class="corp-grid">
            <div class="corp-item"><b>ë§¤ì¶œ ë°©ì–´</b><br>CBAM ëŒ€ì‘ 1%</div>
            <div class="corp-item"><b>ì´ìµ ê°œì„ </b><br>ì˜ì—…ìµ 1.5%â†‘</div>
            <div class="corp-item"><b>ESG ë³´ê³ </b><br>RE100 ì¸ì¦</div>
        </div>
    </div>
</div>

<script>
    // 1. ë§¤ì´ˆ ì‹¤ì‹œê°„ ì‹œì„¸ ë³€ë™
    function updateLive() {
        const ticker = document.getElementById('live-ticker');
        const smp = (240 + Math.random()*10).toFixed(1);
        const loss = (Math.random()*0.08).toFixed(3);
        ticker.innerText = `[LIVE VIX] ì„œìš¸ â‚©250.2 | ì œì£¼ â‚©292.4 | SMP â‚©${smp} | íƒ„ì†Œê¶Œ â‚¬${(64 + Math.random()).toFixed(1)} | ê³„ì ˆ ê°€ì‚°ì  +15% ì ìš© ì¤‘ | `;
        
        if(document.getElementById('val-loss')) {
            document.getElementById('val-loss').innerText = loss + "%";
            document.getElementById('val-ets').innerText = "â‚¬" + (64 + Math.random()).toFixed(1);
        }
    }
    setInterval(updateLive, 1000);

    // 2. ì•„ì½”ë””ì–¸ ë©”ë‰´ í† ê¸€
    function toggleMenu(id) {
        const el = document.getElementById(id);
        const icon = document.getElementById(id + '-icon');
        const isOpen = el.style.display === 'block';
        el.style.display = isOpen ? 'none' : 'block';
        icon.innerText = isOpen ? '+' : '-';
    }

    // 3. ê¸°ì—… êµ¬ë§¤ ì‹œë®¬ë ˆì´ì…˜
    function calcCorp() {
        const rev = document.getElementById('corp-rev').value;
        const res = document.getElementById('corp-res');
        if(!rev) return res.innerText = "";
        res.innerText = `ê¶Œì¥ ì—°ê°„ êµ¬ë§¤ëŸ‰: ${(rev * 150).toLocaleString()} VT`;
    }

    // 4. ì£¼ì†Œ ê²€ìƒ‰
    function findAddress() { new daum.Postcode({ oncomplete: d => document.getElementById('address').value = d.address }).open(); }

    // 5. ê°€ì¹˜ ë¶„ì„ ì‹¤í–‰
    async function calculateVT() {
        const kwh = document.getElementById('kwh').value;
        const addr = document.getElementById('address').value;
        const months = document.getElementById('months').value;
        if(!addr || !kwh) return alert("ì£¼ì†Œì™€ ë°œì „ëŸ‰ì„ ì…ë ¥í•˜ì„¸ìš”.");

        try {
            const res = await fetch(`/api/calculate?kwh=${kwh}&addr=${addr}&months=${months}`);
            const data = await res.json();
            
            document.getElementById('result').style.display = 'block';
            document.getElementById('res-vt').innerText = data.vt;
            document.getElementById('res-cash').innerText = data.revenue;
            
            // ë¶„ì„ ë¡œê·¸ ì¶œë ¥
            document.getElementById('analysis-log').innerHTML = 
                `<strong>[ì—”ì§„ ë¶„ì„ ë¡œê·¸]</strong><br>
                ì§€ì—­ê³„ìˆ˜(L): ${data.log.L} | ì‹œê°„ê³„ìˆ˜(T): ${data.log.T} | íƒ„ì†Œ(C): ${data.log.C} | ê¸°ìƒ(R): ${data.log.R} | ë…¸í›„ ê°ê°€: ${data.log.Age}`;
        } catch (e) { alert("ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜. api/calculate.py íŒŒì¼ì„ í™•ì¸í•˜ì„¸ìš”."); }
    }
</script>
</body>
</html>