<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volti Standard - Global Expert Terminal</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        :root { --primary: #0070f3; --dark: #0a0a0a; --green: #00ff00; --accent: #ff4d4d; --gray: #222; }
        body { font-family: 'Inter', sans-serif; background: #000; color: #eee; margin: 0; font-size: 13px; }
        
        /* ì‹¤ì‹œê°„ ê¸€ë¡œë²Œ ì‹œì„¸ í‹°ì»¤ */
        .vix-ticker { background: var(--dark); color: var(--green); padding: 10px 0; overflow: hidden; white-space: nowrap; font-family: monospace; border-bottom: 1px solid #333; }
        .ticker-content { display: inline-block; animation: ticker 50s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* ë©”ì¸ ë ˆì´ì•„ì›ƒ: 3ì»¬ëŸ¼ìœ¼ë¡œ í™”ë©´ ê½‰ ì±„ì›€ */
        .terminal-grid { display: grid; grid-template-columns: 320px 1fr 320px; gap: 15px; padding: 15px; height: calc(100vh - 100px); }
        .panel { background: #111; border: 1px solid #333; border-radius: 4px; padding: 15px; display: flex; flex-direction: column; overflow-y: auto; }
        h2 { font-size: 14px; color: var(--primary); border-bottom: 1px solid #333; padding-bottom: 8px; margin: 0 0 15px 0; text-transform: uppercase; letter-spacing: 1px; }

        /* ë°ì´í„° í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        table { width: 100%; border-collapse: collapse; margin-bottom: 15px; }
        th { text-align: left; color: #888; font-size: 11px; padding: 5px; border-bottom: 1px solid #222; }
        td { padding: 8px 5px; border-bottom: 1px solid #1a1a1a; font-family: monospace; }
        .up { color: var(--green); } .down { color: var(--accent); }

        /* ì…ë ¥ ë° ë²„íŠ¼ */
        input, select, button { width: 100%; padding: 10px; margin: 5px 0; background: #222; border: 1px solid #444; color: #fff; border-radius: 3px; }
        button { background: var(--primary); cursor: pointer; font-weight: bold; border: none; }
        button:hover { background: #0056b3; }

        /* ê²°ê³¼ì°½ */
        #result-display { background: #1a1a1a; padding: 15px; border: 1px solid var(--primary); margin-top: 10px; border-radius: 4px; }
        .log-text { font-size: 11px; color: #aaa; margin-top: 10px; line-height: 1.4; }

        /* ì•„ì½”ë””ì–¸ */
        .accordion { margin-bottom: 5px; border: 1px solid #222; }
        .acc-header { background: #1a1a1a; padding: 8px; cursor: pointer; display: flex; justify-content: space-between; font-size: 12px; }
        .acc-content { padding: 10px; display: none; font-size: 11px; color: #ccc; border-top: 1px solid #222; }
    </style>
</head>
<body>

<div class="vix-ticker">
    <div class="ticker-content" id="live-ticker">
        [VIX LIVE] KRW/USD: 1,324.50 | BTC/USD: $42,150.22 | KR-SMP: â‚©242.15 | EU-ETS: â‚¬64.50 | ASIA-LNG: $12.40 | US-REC: $34.10 | Loading Real-time Streams...
    </div>
</div>

<div class="terminal-grid">
    <div class="panel">
        <h2>VT Analysis Engine</h2>
        <input type="text" id="address" placeholder="SEARCH LOCATION" readonly onclick="findAddress()">
        <input type="number" id="kwh" placeholder="POWER GEN (kWh)">
        <select id="months">
            <option value="1">NEW PLANT (< 1M)</option>
            <option value="12">STABLE (1Y)</option>
            <option value="36">AGED (> 3Y)</option>
        </select>
        <button onclick="calculateVT()">RUN ANALYSIS</button>

        <div id="result-display" style="display:none;">
            <div style="font-size:11px; color:#888;">CERTIFIED VALUE</div>
            <div id="res-vt" style="font-size:24px; font-weight:bold; color:var(--green);">0 VT</div>
            <div style="font-size:11px; color:#888; margin-top:10px;">ESTIMATED REVENUE</div>
            <div id="res-cash" style="font-size:18px; font-weight:bold;">â‚©0</div>
            <div id="analysis-log" class="log-text"></div>
        </div>
        
        <h2 style="margin-top:20px;">Enterprise Guide</h2>
        <input type="number" id="corp-rev" placeholder="ANNUAL REV (100M KRW)" oninput="calcCorp()">
        <div id="corp-res" style="padding:10px; color:var(--primary); font-weight:bold;"></div>
        <p style="font-size:11px; color:#666;">*ìˆ˜ì¶œ ê¸°ì—…ì„ ìœ„í•œ CBAM/RE100 ëŒ€ì‘ ê¶Œì¥ ë§¤ì…ëŸ‰ì…ë‹ˆë‹¤.</p>
    </div>

    <div class="panel">
        <h2>Real-time Volti Factors & History</h2>
        
        <table>
            <thead><tr><th>FACTOR</th><th>VALUE</th><th>DELTA</th><th>STATUS</th></tr></thead>
            <tbody id="factor-tbody">
                <tr><td>Grid Loss (L)</td><td id="l-val">1.250</td><td class="up">+0.002</td><td>Stable</td></tr>
                <tr><td>Carbon Int. (C)</td><td id="c-val">1.104</td><td class="down">-0.005</td><td>Green</td></tr>
                <tr><td>Time Weight (T)</td><td id="t-val">1.500</td><td>0.000</td><td>Peak</td></tr>
            </tbody>
        </table>

        <h2>Price Change History (24H)</h2>
        <table style="font-size:11px;">
            <thead><tr><th>TIME</th><th>VIX INDEX</th><th>SMP (KRW)</th><th>VOL (VT)</th></tr></thead>
            <tbody id="history-tbody">
                </tbody>
        </table>
    </div>

    <div class="panel">
        <h2>Global Market Indicators</h2>
        
        <div class="accordion">
            <div class="acc-header" onclick="toggleAcc('g1')"><span>ğŸ’± Currency / Forex</span><span>+</span></div>
            <div id="g1" class="acc-content" style="display:block;">
                <div style="display:flex; justify-content:space-between;"><span>USD/KRW</span><span class="up">1,324.5</span></div>
                <div style="display:flex; justify-content:space-between;"><span>EUR/KRW</span><span class="up">1,442.1</span></div>
                <div style="display:flex; justify-content:space-between;"><span>JPY/KRW</span><span class="down">8.92</span></div>
            </div>
        </div>

        <div class="accordion">
            <div class="acc-header" onclick="toggleAcc('g2')"><span>ğŸŒ± Carbon & ESG</span><span>+</span></div>
            <div id="g2" class="acc-content" style="display:block;">
                <div style="display:flex; justify-content:space-between;"><span>EU-ETS</span><span class="up">â‚¬64.52</span></div>
                <div style="display:flex; justify-content:space-between;"><span>KAU-24</span><span class="down">â‚©14,200</span></div>
                <div style="display:flex; justify-content:space-between;"><span>RE100 Premium</span><span>+12.5%</span></div>
            </div>
        </div>

        <div class="accordion">
            <div class="acc-header" onclick="toggleAcc('g3')"><span>ğŸ›¢ï¸ Energy Commodities</span><span>+</span></div>
            <div id="g3" class="acc-content" style="display:block;">
                <div style="display:flex; justify-content:space-between;"><span>WTI Oil</span><span class="up">$72.45</span></div>
                <div style="display:flex; justify-content:space-between;"><span>Brent Oil</span><span class="up">$77.12</span></div>
                <div style="display:flex; justify-content:space-between;"><span>Natural Gas</span><span class="down">$2.45</span></div>
            </div>
        </div>
        
        <div style="margin-top:auto; font-size:10px; color:#444; text-align:center;">
            VOLTI TERMINAL V.2.1 | STABLE CONNECTION
        </div>
    </div>
</div>

<script>
    // 1. ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸ (í„°ë¯¸ë„ ëŠë‚Œ)
    function updateTerminal() {
        const smp = (240 + Math.random()*5).toFixed(2);
        const ticker = document.getElementById('live-ticker');
        ticker.innerText = `[MARKET] KR-SMP: â‚©${smp} | US-WTI: $${(72+Math.random()).toFixed(2)} | Carbon: â‚¬${(64+Math.random()).toFixed(2)} | BTC: $${(42000+Math.random()*100).toLocaleString()} | [ALERT] HIGH DEMAND IN SEOUL | `;
        
        document.getElementById('l-val').innerText = (1.2 + Math.random()*0.1).toFixed(3);
        document.getElementById('c-val').innerText = (1.1 + Math.random()*0.05).toFixed(3);
    }
    setInterval(updateTerminal, 1000);

    // 2. ê°€ìƒì˜ íˆìŠ¤í† ë¦¬ ë°ì´í„° ìƒì„±
    function initHistory() {
        const tbody = document.getElementById('history-tbody');
        for(let i=0; i<15; i++) {
            const row = `<tr><td>${23-i}:00</td><td>${(1.2 + Math.random()*0.2).toFixed(4)}</td><td>${(230 + Math.random()*20).toFixed(1)}</td><td>${(Math.random()*1000).toFixed(0)}</td></tr>`;
            tbody.innerHTML += row;
        }
    }
    initHistory();

    function toggleAcc(id) {
        const el = document.getElementById(id);
        el.style.display = (el.style.display === 'block') ? 'none' : 'block';
    }

    function findAddress() { new daum.Postcode({ oncomplete: d => document.getElementById('address').value = d.address }).open(); }

    async function calculateVT() {
        const kwh = document.getElementById('kwh').value;
        const addr = document.getElementById('address').value;
        const months = document.getElementById('months').value;
        if(!addr || !kwh) return alert("INPUT DATA REQUIRED");

        const res = await fetch(`/api/calculate?kwh=${kwh}&addr=${addr}&months=${months}`);
        const data = await res.json();

        document.getElementById('result-display').style.display = 'block';
        document.getElementById('res-vt').innerText = data.vt + " VT";
        document.getElementById('res-cash').innerText = "â‚©" + data.revenue;
        document.getElementById('analysis-log').innerText = `ENGINE LOG: L=${data.log.L}, T=${data.log.T}, C=${data.log.C}, R=${data.log.R}, AGE=${data.log.Age}. Verified by Volti Standard.`;
    }

    function calcCorp() {
        const rev = document.getElementById('corp-rev').value;
        document.getElementById('corp-res').innerText = rev ? `TARGET: ${(rev * 150).toLocaleString()} VT / YR` : "";
    }
</script>
</body>
</html>