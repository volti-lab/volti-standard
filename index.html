<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volti Standard - Global Expert Terminal</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        :root { 
            --primary: #0070f3; --dark: #0a0a0a; --green: #00ff00; --accent: #ff4d4d; 
            --yellow-flash: #FFD700; --esg-green: #28a745; 
        }
        body { font-family: 'Inter', sans-serif; background: #000; color: #eee; margin: 0; font-size: 13px; }
        
        /* ìƒë‹¨ ìœ í‹¸ë¦¬í‹° ë°” */
        .top-utility-bar { display: flex; background: var(--dark); border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 1000; align-items: center; }
        .vix-ticker { flex: 1; color: var(--green); padding: 10px 0; overflow: hidden; white-space: nowrap; font-family: monospace; border-right: 1px solid #333; }
        .ticker-content { display: inline-block; animation: ticker 50s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .lang-selector { padding: 0 15px; display: flex; gap: 10px; font-size: 11px; }
        .lang-btn { cursor: pointer; color: #666; } .lang-btn.active { color: var(--primary); text-decoration: underline; }

        header { background: #1a1a1a; padding: 15px 0; text-align: center; border-bottom: 1px solid #333; }
        .logo-text { font-size: 24px; font-weight: bold; color: #fff; }
        .volti-flash { color: var(--yellow-flash); margin-right: 5px; }

        /* ë©”ì¸ ê·¸ë¦¬ë“œ (ìƒë‹¨ 2ê°œ ì„¹ì…˜) */
        .terminal-grid { display: grid; grid-template-columns: 350px 1fr 320px; gap: 15px; padding: 15px; }
        .panel { background: #111; border: 1px solid #333; border-radius: 4px; padding: 15px; overflow: hidden; }
        h2 { font-size: 13px; color: var(--primary); border-bottom: 1px solid #333; padding-bottom: 8px; margin: 0 0 12px 0; text-transform: uppercase; }

        /* ë²•ì¸ êµ¬ë§¤ ê°€ì´ë“œ (í•˜ë‹¨ ì™€ì´ë“œ ì„¹ì…˜) */
        .bottom-panel { grid-column: span 3; background: #111; border: 1px solid var(--primary); border-radius: 4px; padding: 20px; margin: 0 15px 15px 15px; }
        .corp-simulator { display: grid; grid-template-columns: 1fr 1fr 1.2fr; gap: 30px; }

        table { width: 100%; border-collapse: collapse; font-size: 11px; }
        th { text-align: left; color: #888; padding: 5px; border-bottom: 1px solid #222; }
        td { padding: 7px 5px; border-bottom: 1px solid #1a1a1a; font-family: monospace; }
        .up { color: var(--green); } .down { color: var(--accent); }

        input, select, button { width: 100%; padding: 10px; margin: 5px 0; background: #222; border: 1px solid #444; color: #fff; border-radius: 3px; }
        button { background: var(--primary); cursor: pointer; font-weight: bold; border: none; }
        
        .stock-item { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted #222; }
        .result-box { background: #1a1a1a; padding: 15px; border: 1px solid #333; border-radius: 4px; height: 100%; }
    </style>
</head>
<body>

<div class="top-utility-bar">
    <div class="vix-ticker">
        <div class="ticker-content" id="live-ticker">[VIX LIVE] KR-SMP: â‚©242.15 | Loading Market Data...</div>
    </div>
    <div class="lang-selector">
        <span class="lang-btn active" id="btn-ko" onclick="setLang('ko')">í•œê¸€</span> | 
        <span class="lang-btn" id="btn-en" onclick="setLang('en')">English</span>
    </div>
</div>

<header>
    <div class="logo-text"><span class="volti-flash">âš¡</span>Volti Standard Platform</div>
    <div id="txt-slogan" style="color:var(--esg-green); font-size:12px; margin-top:5px;">ğŸŒ± ESG íƒ„ì†Œ ì¤‘ë¦½ ë° ì—ë„ˆì§€ ê°€ì¹˜ í†µí•© í„°ë¯¸ë„</div>
</header>

<main class="terminal-grid">
    <div class="panel">
        <h2 id="h-engine">VT ë¶„ì„ ì—”ì§„</h2>
        <input type="text" id="address" placeholder="ë°œì „ì†Œ ì£¼ì†Œ ê²€ìƒ‰" readonly onclick="findAddress()">
        <input type="number" id="kwh" placeholder="ë°œì „ëŸ‰ (kWh)">
        <select id="production-method">
            <option value="solar">íƒœì–‘ê´‘ (Solar)</option>
            <option value="wind">í’ë ¥ (Wind)</option>
            <option value="hydro">ìˆ˜ë ¥ (Hydro)</option>
        </select>
        <select id="months">
            <option value="1">ì‹ ì¶• ì„¤ë¹„ (1M)</option>
            <option value="36">ë…¸í›„ ì„¤ë¹„ (3Y+)</option>
        </select>
        <button onclick="calculateVT()" id="btn-run">ë¶„ì„ ì‹¤í–‰</button>
        <div id="result-display" style="display:none; margin-top:10px; border-top:1px solid #333; padding-top:10px;">
            <div id="res-vt" style="font-size:22px; color:var(--green); font-weight:bold;">0 VT</div>
            <div id="analysis-log" style="font-size:10px; color:#666;"></div>
        </div>
    </div>

    <div class="panel">
        <h2 id="h-factors">ì‹¤ì‹œê°„ ë³€ë™ ì§€í‘œ & íˆìŠ¤í† ë¦¬</h2>
        <table>
            <thead><tr><th>FACTOR</th><th>VALUE</th><th>DELTA</th></tr></thead>
            <tbody>
                <tr><td>Grid Loss (L)</td><td id="l-val">1.250</td><td class="up">+0.002</td></tr>
                <tr><td>Carbon Int. (C)</td><td id="c-val">1.104</td><td class="down">-0.005</td></tr>
            </tbody>
        </table>
        <h2 style="margin-top:15px;" id="h-history">Price History (24H)</h2>
        <div style="height:150px; overflow-y:auto;"><table id="history-tbody"></table></div>
    </div>

    <div class="panel">
        <h2 id="h-global">Global Power Prices</h2>
        <div class="stock-item"><span>K-SMP</span><span class="up">â‚©242.1</span></div>
        <div class="stock-item"><span>D-EEX</span><span class="down">â‚¬125.4</span></div>
        <h2 style="margin-top:20px;" id="h-market">Market Indicators</h2>
        <div class="stock-item"><span>EU-ETS</span><span class="up">â‚¬64.5</span></div>
        <div class="stock-item"><span>WTI Oil</span><span class="up">$72.4</span></div>
    </div>

    <section class="bottom-panel">
        <h2 id="h-corp" style="color:var(--yellow-flash); border-color:var(--yellow-flash);">ë²•ì¸ ì „ìš© êµ¬ë§¤ ì‹œë®¬ë ˆì´í„° (Corporate Purchase Guide)</h2>
        <div class="corp-simulator">
            <div class="inputs">
                <label style="font-size:11px;">1. ê¸°ì—… ê·œëª¨ (ì—°ê°„ ë§¤ì¶œì•¡ / ì–µì›)</label>
                <input type="number" id="corp-rev" placeholder="ì˜ˆ: 100" oninput="runCorpSim()">
                
                <label style="font-size:11px; margin-top:10px; display:block;">2. ì£¼ìš” ìˆ˜ì¶œ/ì‚¬ì—… ì§€ì—­ (ê·œì œ ê°€ì¤‘ì¹˜)</label>
                <select id="corp-region" onchange="runCorpSim()">
                    <option value="1.0">êµ­ë‚´ ì‚¬ì—… ìœ„ì£¼ (Domestic)</option>
                    <option value="1.5">EU ìˆ˜ì¶œ (CBAM ì ìš©)</option>
                    <option value="1.3">ë¯¸êµ­/ê¸€ë¡œë²Œ (RE100 ê³µì‹œ)</option>
                </select>
            </div>
            
            <div class="inputs">
                <label style="font-size:11px;">3. íƒ„ì†Œ ê°ì¶• ëª©í‘œ ë ˆë²¨</label>
                <select id="corp-goal" onchange="runCorpSim()">
                    <option value="0.1">ì¤€ë²• ê°ì‹œ ë ˆë²¨ (ê¸°ë³¸ 10%)</option>
                    <option value="0.5">ESG ì„ ë„ ê¸°ì—… (50%)</option>
                    <option value="1.0">Net-Zero ë‹¬ì„± (100%)</option>
                </select>
                
                <label style="font-size:11px; margin-top:10px; display:block;">4. ì ìš© ì—…ì¢…</label>
                <select id="corp-type" onchange="runCorpSim()">
                    <option value="1.0">ì¼ë°˜ ì„œë¹„ìŠ¤/IT</option>
                    <option value="1.8">ì œì¡°/ì¤‘ê³µì—… (ê³ íƒ„ì†Œ)</option>
                    <option value="1.4">ìœ í†µ/ë¬¼ë¥˜</option>
                </select>
            </div>

            <div class="result-box">
                <div id="corp-txt-head" style="font-size:12px; color:#888;">ê¶Œì¥ Volti êµ¬ë§¤ëŸ‰ (Recommended Volume)</div>
                <div id="corp-total-vt" style="font-size:32px; font-weight:bold; color:var(--primary); margin:10px 0;">0 VT</div>
                <div id="corp-detail-log" style="font-size:11px; color:#666; line-height:1.6;">
                    í•­ëª©ì„ ì„ íƒí•˜ë©´ ë²•ì¸ ë§ì¶¤í˜• ê°€ì´ë“œê°€ ì¶œë ¥ë©ë‹ˆë‹¤.
                </div>
            </div>
        </div>
    </section>
</main>

<script>
    const langData = {
        ko: {
            slogan: "ğŸŒ± ESG íƒ„ì†Œ ì¤‘ë¦½ ë° ì—ë„ˆì§€ ê°€ì¹˜ í†µí•© í„°ë¯¸ë„",
            hEngine: "VT ë¶„ì„ ì—”ì§„", hCorp: "ë²•ì¸ ì „ìš© êµ¬ë§¤ ì‹œë®¬ë ˆì´í„°", hFactors: "ì‹¤ì‹œê°„ ë³€ë™ ì§€í‘œ", hHistory: "ì´ë ¥ (24H)", hGlobal: "ê¸€ë¡œë²Œ ì „ë ¥ ë‹¨ê°€", hMarket: "ì‹œì¥ ì§€í‘œ",
            btnRun: "ë¶„ì„ ì‹¤í–‰", phRev: "ì—°ê°„ ë§¤ì¶œì•¡ (ì–µì›)"
        },
        en: {
            slogan: "ğŸŒ± ESG Carbon Neutral & Energy Value Terminal",
            hEngine: "VT ANALYSIS ENGINE", hCorp: "CORPORATE PURCHASE SIMULATOR", hFactors: "LIVE FACTORS", hHistory: "HISTORY (24H)", hGlobal: "GLOBAL POWER PRICES", hMarket: "MARKET INDICATORS",
            btnRun: "RUN ANALYSIS", phRev: "ANNUAL REV (100M KRW)"
        }
    };

    function setLang(lang) {
        const d = langData[lang];
        document.getElementById('txt-slogan').innerText = d.slogan;
        document.getElementById('h-engine').innerText = d.hEngine;
        document.getElementById('h-corp').innerText = d.hCorp;
        document.getElementById('h-factors').innerText = d.hFactors;
        document.getElementById('h-history').innerText = d.hHistory;
        document.getElementById('h-global').innerText = d.hGlobal;
        document.getElementById('h-market').innerText = d.hMarket;
        document.getElementById('btn-run').innerText = d.btnRun;
        document.getElementById('corp-rev').placeholder = d.phRev;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-' + lang).classList.add('active');
    }

    // ë²•ì¸ êµ¬ë§¤ëŸ‰ ì‹œë®¬ë ˆì´ì…˜ ë¡œì§
    function runCorpSim() {
        const rev = document.getElementById('corp-rev').value;
        if(!rev) return;
        
        const region = parseFloat(document.getElementById('corp-region').value);
        const goal = parseFloat(document.getElementById('corp-goal').value);
        const type = parseFloat(document.getElementById('corp-type').value);
        
        // ê°€ì‚° ê³µì‹: ë§¤ì¶œ 1ì–µë‹¹ ê¸°ë³¸ 100VT * ì§€ì—­ê°€ì¤‘ì¹˜ * ëª©í‘œì¹˜ * ì—…ì¢…ê°€ì¤‘ì¹˜
        const baseVT = rev * 100;
        const totalVT = Math.round(baseVT * region * goal * type);
        
        document.getElementById('corp-total-vt').innerText = totalVT.toLocaleString() + " VT";
        document.getElementById('corp-detail-log').innerHTML = `
            â€¢ ì§€ì—­ ê·œì œ ê°€ì¤‘ì¹˜: x${region}<br>
            â€¢ íƒ„ì†Œ ëª©í‘œ ê°€ì¤‘ì¹˜: x${goal}<br>
            â€¢ ì—…ì¢… ë¶€í•˜ ê°€ì¤‘ì¹˜: x${type}<br>
            <strong>* í•´ë‹¹ ìˆ˜ì¹˜ëŠ” CBAM ë° ESG ê³µì‹œ ëŒ€ì‘ì„ ìœ„í•œ ê¶Œì¥ëŸ‰ì…ë‹ˆë‹¤.</strong>
        `;
    }

    function updateTerminal() {
        const smp = (240 + Math.random()*5).toFixed(2);
        document.getElementById('live-ticker').innerText = `[VIX LIVE] KR-SMP: â‚©${smp} | EU-EEX: â‚¬125.4 | Carbon: â‚¬64.5 | BTC: $42,150 | Market Stable...`;
        document.getElementById('l-val').innerText = (1.2 + Math.random()*0.1).toFixed(3);
    }
    setInterval(updateTerminal, 1000);

    function initHistory() {
        const tbody = document.getElementById('history-tbody');
        for(let i=0; i<10; i++) {
            tbody.innerHTML += `<tr><td>${23-i}:00</td><td>${(1.2+Math.random()*0.1).toFixed(4)}</td><td>${(230+Math.random()*10).toFixed(1)}</td></tr>`;
        }
    }
    initHistory();
    function findAddress() { new daum.Postcode({ oncomplete: d => document.getElementById('address').value = d.address }).open(); }
    async function calculateVT() {
        const kwh = document.getElementById('kwh').value;
        const addr = document.getElementById('address').value;
        if(!addr || !kwh) return alert("DATA REQUIRED");
        const res = await fetch(`/api/calculate?kwh=${kwh}&addr=${addr}&months=${document.getElementById('months').value}&method=${document.getElementById('production-method').value}`);
        const data = await res.json();
        document.getElementById('result-display').style.display = 'block';
        document.getElementById('res-vt').innerText = data.vt + " VT";
        document.getElementById('analysis-log').innerText = `ENGINE LOG: L=${data.log.L}, C=${data.log.C}, AGE=${data.log.Age}`;
    }
    setLang('ko');
</script>
</body>
</html>