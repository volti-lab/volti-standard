<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volti Standard - Strategic Energy Terminal</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>
        :root { 
            --primary: #0070f3; --dark: #0a0a0a; --green: #00ff00; --accent: #ff4d4d; 
            --yellow: #FFD700; --esg: #28a745; --warning: #ffa500;
        }
        body { font-family: 'Inter', sans-serif; background: #000; color: #eee; margin: 0; font-size: 13px; }
        
        /* ìƒë‹¨ ìœ í‹¸ë¦¬í‹° ë°” */
        .top-utility-bar { display: flex; background: var(--dark); border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 1000; align-items: center; }
        .vix-ticker { flex: 1; color: var(--green); padding: 10px 0; overflow: hidden; white-space: nowrap; font-family: monospace; border-right: 1px solid #333; }
        .ticker-content { display: inline-block; animation: ticker 50s linear infinite; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }
        .lang-selector { padding: 0 15px; display: flex; gap: 10px; font-size: 11px; }
        .lang-btn { cursor: pointer; color: #666; } .lang-btn.active { color: var(--primary); text-decoration: underline; }

        header { background: #1a1a1a; padding: 15px 0; text-align: center; border-bottom: 1px solid #333; }
        .logo-text { font-size: 24px; font-weight: bold; color: #fff; }
        .volti-flash { color: var(--yellow); margin-right: 5px; }

        /* ë©”ì¸ ê·¸ë¦¬ë“œ */
        .terminal-grid { display: grid; grid-template-columns: 350px 1fr 320px; gap: 15px; padding: 15px; }
        .panel { background: #111; border: 1px solid #333; border-radius: 4px; padding: 15px; overflow: hidden; }
        h2 { font-size: 13px; color: var(--primary); border-bottom: 1px solid #333; padding-bottom: 8px; margin: 0 0 12px 0; text-transform: uppercase; }

        /* ë²•ì¸ ì‹œë®¬ë ˆì´í„° (CBAM ê°•í™”) */
        .bottom-panel { grid-column: span 3; background: #111; border: 1px solid var(--primary); border-radius: 4px; padding: 20px; margin: 0 15px 15px 15px; }
        .corp-simulator { display: grid; grid-template-columns: 1fr 1fr 1.2fr; gap: 30px; }

        table { width: 100%; border-collapse: collapse; font-size: 11px; }
        th { text-align: left; color: #888; padding: 5px; border-bottom: 1px solid #222; }
        td { padding: 7px 5px; border-bottom: 1px solid #1a1a1a; font-family: monospace; }
        .up { color: var(--green); } .down { color: var(--accent); } .warn { color: var(--warning); }

        input, select, button { width: 100%; padding: 10px; margin: 5px 0; background: #222; border: 1px solid #444; color: #fff; border-radius: 3px; }
        button { background: var(--primary); cursor: pointer; font-weight: bold; border: none; }
        
        .result-box { background: #1a1a1a; padding: 15px; border: 1px solid #333; border-radius: 4px; height: 100%; position: relative; }
        .badge { position: absolute; top: 10px; right: 10px; font-size: 10px; padding: 2px 6px; border-radius: 10px; background: var(--accent); }
    </style>
</head>
<body>

<div class="top-utility-bar">
    <div class="vix-ticker">
        <div class="ticker-content" id="live-ticker">[LIVE MARKET] CBAM ê·œì œ ì§€ìˆ˜ ìƒìŠ¹ ì¤‘ | ì œì£¼ ì¶œë ¥ì œì–´ ìœ„í—˜ë„: HIGH | Loading...</div>
    </div>
    <div class="lang-selector">
        <span class="lang-btn active" id="btn-ko" onclick="setLang('ko')">í•œê¸€</span> | 
        <span class="lang-btn" id="btn-en" onclick="setLang('en')">English</span>
    </div>
</div>

<header>
    <div class="logo-text"><span class="volti-flash">âš¡</span>Volti Strategic Terminal</div>
    <div id="txt-slogan" style="color:var(--esg); font-size:12px; margin-top:5px;">ğŸŒ± ë¶„ì‚°ì—ë„ˆì§€ë²• ë° CBAM ëŒ€ì‘ ì—ë„ˆì§€ ìì‚° ê´€ë¦¬ í‘œì¤€</div>
</header>

<main class="terminal-grid">
    <div class="panel">
        <h2 id="h-engine">VT ë¶„ì„ ì—”ì§„ (v.2026)</h2>
        <input type="text" id="address" placeholder="ë°œì „ì†Œ ì£¼ì†Œ ê²€ìƒ‰" readonly onclick="findAddress()">
        <input type="number" id="kwh" placeholder="ë°œì „ëŸ‰ (kWh)">
        <select id="production-method">
            <option value="solar">íƒœì–‘ê´‘ (Solar) - ì¶œë ¥ì œì–´ ë¦¬ìŠ¤í¬ ì ìš©</option>
            <option value="wind">í’ë ¥ (Wind) - ê³„í†µ ì•ˆì •ì„± ê°€ì‚°</option>
        </select>
        <button onclick="calculateVT()" id="btn-run">ì „ëµ ë¶„ì„ ì‹¤í–‰</button>
        <div id="result-display" style="display:none; margin-top:10px;">
            <div id="res-vt" style="font-size:22px; color:var(--green); font-weight:bold;">0 VT</div>
            <div id="analysis-log" style="font-size:10px; color:#aaa; margin-top:5px; line-height:1.4;"></div>
        </div>
    </div>

    <div class="panel">
        <h2 id="h-factors">Real-time Risk & Value Factors</h2>
        <table>
            <thead><tr><th>FACTOR</th><th>VALUE</th><th>STATUS</th></tr></thead>
            <tbody>
                <tr><td>Curtailment Risk (G)</td><td id="v-g" class="warn">High (0.85)</td><td>ì¶œë ¥ì œì–´ ì£¼ì˜</td></tr>
                <tr><td>Grid Locality (L)</td><td id="v-l">1.320</td><td>ë¶„ì‚°ë²• ê°€ì‚°</td></tr>
                <tr><td>Carbon Gap (C)</td><td id="v-c">1.104</td><td>CBAM ì—°ë™</td></tr>
            </tbody>
        </table>
        <h2 style="margin-top:15px;" id="h-history">VIX Price History</h2>
        <div style="height:120px; overflow-y:auto;"><table id="history-tbody"></table></div>
    </div>

    <div class="panel">
        <h2 id="h-global">Global Indicators</h2>
        <div style="padding:5px 0;"><span>EU-ETS (íƒ„ì†Œê¶Œ)</span><span class="up" style="float:right;">â‚¬64.5</span></div>
        <div style="padding:5px 0;"><span>K-SMP (ì „ë ¥ê°€)</span><span class="up" style="float:right;">â‚©242.1</span></div>
        <div style="padding:5px 0; color:var(--accent);"><span>CBAM Tax Index</span><span style="float:right;">+12.4%</span></div>
    </div>

    <section class="bottom-panel">
        <h2 id="h-corp" style="color:var(--yellow); border-color:var(--yellow);">Corporate Strategy & CBAM Simulator</h2>
        <div class="corp-simulator">
            <div class="inputs">
                <label style="font-size:11px;">1. ì—°ê°„ ìˆ˜ì¶œì•¡ (ì–µì› / EUí–¥ ê¸°ì¤€)</label>
                <input type="number" id="corp-export" placeholder="ì˜ˆ: 50" oninput="runCorpSim()">
                <label style="font-size:11px; margin-top:10px; display:block;">2. ìˆ˜ì¶œ í’ˆëª© (íƒ„ì†Œ ì§‘ì•½ë„)</label>
                <select id="corp-item-type" onchange="runCorpSim()">
                    <option value="1.0">ì¼ë°˜ ì†Œë¹„ì¬</option>
                    <option value="2.5">ì² ê°•/ê¸ˆì† (ê³ íƒ„ì†Œ CBAM)</option>
                    <option value="1.8">í™”í•™/ë¹„ë£Œ</option>
                </select>
            </div>
            
            <div class="inputs">
                <label style="font-size:11px;">3. í˜„í–‰ ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨ (%)</label>
                <input type="number" id="corp-re-percent" value="5" oninput="runCorpSim()">
                <label style="font-size:11px; margin-top:10px; display:block;">4. 2026 ê·œì œ ëŒ€ì‘ ìˆ˜ì¤€</label>
                <select id="corp-reg-level" onchange="runCorpSim()">
                    <option value="1.0">ìµœì†Œ ëŒ€ì‘ (ê´€ì„¸ ë¶€ê³¼ ê°ìˆ˜)</option>
                    <option value="2.0">ì „ëµì  Net-Zero (ê´€ì„¸ ë©´ì œ ëª©í‘œ)</option>
                </select>
            </div>

            <div class="result-box">
                <div class="badge">CBAM STRATEGY</div>
                <div style="font-size:12px; color:#888;">ì˜ˆìƒ ê´€ì„¸ ì ˆê°ì•¡ (Saved Tax)</div>
                <div id="corp-tax-saved" style="font-size:28px; font-weight:bold; color:var(--green); margin:5px 0;">â‚©0</div>
                <div style="font-size:12px; color:#888;">ê¶Œì¥ Volti ë§¤ì…ëŸ‰</div>
                <div id="corp-total-vt" style="font-size:20px; font-weight:bold; color:var(--primary);">0 VT</div>
                <div id="corp-detail-log" style="font-size:11px; color:#666; margin-top:5px;"></div>
            </div>
        </div>
    </section>
</main>

<script>
    const langData = {
        ko: { slogan: "ğŸŒ± ë¶„ì‚°ì—ë„ˆì§€ë²• ë° CBAM ëŒ€ì‘ ì—ë„ˆì§€ ìì‚° ê´€ë¦¬ í‘œì¤€", hEngine: "VT ë¶„ì„ ì—”ì§„ (v.2026)", hCorp: "ë²•ì¸ ì „ëµ ë° CBAM ì‹œë®¬ë ˆì´í„°", hFactors: "ì‹¤ì‹œê°„ ë¦¬ìŠ¤í¬ ë° ê°€ì¹˜ ìš”ì¸", hHistory: "ì´ë ¥ (24H)", hGlobal: "ê¸€ë¡œë²Œ ì§€í‘œ", hMarket: "ì‹œì¥ ì§€í‘œ", btnRun: "ì „ëµ ë¶„ì„ ì‹¤í–‰" },
        en: { slogan: "ğŸŒ± ESG Assets & CBAM Regulatory Terminal", hEngine: "VT STRATEGIC ENGINE", hCorp: "STRATEGY & CBAM SIMULATOR", hFactors: "LIVE RISK FACTORS", hHistory: "HISTORY (24H)", hGlobal: "GLOBAL DATA", hMarket: "MARKET DATA", btnRun: "RUN ANALYSIS" }
    };

    function setLang(lang) {
        const d = langData[lang];
        document.getElementById('txt-slogan').innerText = d.slogan;
        document.getElementById('h-engine').innerText = d.hEngine;
        document.getElementById('h-corp').innerText = d.hCorp;
        document.getElementById('h-factors').innerText = d.hFactors;
        document.getElementById('h-history').innerText = d.hHistory;
        document.getElementById('h-global').innerText = d.hGlobal;
        document.getElementById('btn-run').innerText = d.btnRun;
        document.querySelectorAll('.lang-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('btn-' + lang).classList.add('active');
    }

    // CBAM ê¸°ë°˜ ë²•ì¸ ì‹œë®¬ë ˆì´ì…˜
    function runCorpSim() {
        const exportAmt = document.getElementById('corp-export').value;
        const rePct = document.getElementById('corp-re-percent').value;
        if(!exportAmt) return;
        
        const itemWeight = parseFloat(document.getElementById('corp-item-type').value);
        const regLevel = parseFloat(document.getElementById('corp-reg-level').value);
        
        // ì‹œë®¬ë ˆì´ì…˜ ê³µì‹: ìˆ˜ì¶œì•¡ * íƒ„ì†Œê°€ì¤‘ì¹˜ * (100-ì¬ìƒì—ë„ˆì§€ë¹„ìœ¨)/100 * ê´€ì„¸ìœ¨(í‰ê·  3%)
        const savedTax = Math.round(exportAmt * 100000000 * itemWeight * ((100-rePct)/100) * 0.03);
        const targetVT = Math.round(savedTax / 250); // 1VTë‹¹ 250ì› ê°€ì¹˜ í™˜ì‚°
        
        document.getElementById('corp-tax-saved').innerText = "â‚©" + (savedTax/1000000).toFixed(1) + "ì–µ";
        document.getElementById('corp-total-vt').innerText = targetVT.toLocaleString() + " VT";
        document.getElementById('corp-detail-log').innerHTML = `â€¢ íƒ„ì†Œ ì§‘ì•½ë„ í˜ë„í‹°: x${itemWeight}<br>â€¢ VT í™•ë³´ ì‹œ ê´€ì„¸ ë¦¬ìŠ¤í¬ ${(rePct < 50 ? 'ëŒ€í­' : 'ì†Œí­')} ê°ì†Œ`;
    }

    function updateTerminal() {
        const ticker = document.getElementById('live-ticker');
        const gRisk = (0.7 + Math.random()*0.3).toFixed(2);
        ticker.innerText = `[ALERT] ì œì£¼-í˜¸ë‚¨ ì¶œë ¥ì œì–´ ìœ„í—˜ì§€ìˆ˜: ${gRisk} (ì£¼ì˜) | EU íƒ„ì†Œêµ­ê²½ì„¸ ì§€ìˆ˜: 1.12 | [ë¶„ì‚°ë²•] ì§€ì—­ ì°¨ë“± ê°€ì‚°ì  ë™ê¸°í™” ì™„ë£Œ | `;
        document.getElementById('v-g').innerText = `${gRisk < 0.8 ? 'Warning' : 'Stable'} (${gRisk})`;
        document.getElementById('v-g').className = gRisk < 0.8 ? 'warn' : 'up';
    }
    setInterval(updateTerminal, 2000);

    function initHistory() {
        const tbody = document.getElementById('history-tbody');
        for(let i=0; i<8; i++) {
            tbody.innerHTML += `<tr><td>${23-i}:00</td><td>${(1.2+Math.random()*0.1).toFixed(4)}</td><td class="up">+0.001</td></tr>`;
        }
    }
    initHistory();
    function findAddress() { new daum.Postcode({ oncomplete: d => document.getElementById('address').value = d.address }).open(); }
    
    async function calculateVT() {
        const kwh = document.getElementById('kwh').value;
        const addr = document.getElementById('address').value;
        if(!addr || !kwh) return alert("DATA REQUIRED");
        const res = await fetch(`/api/calculate?kwh=${kwh}&addr=${addr}&method=${document.getElementById('production-method').value}`);
        const data = await res.json();
        document.getElementById('result-display').style.display = 'block';
        document.getElementById('res-vt').innerText = data.vt + " VT";
        document.getElementById('analysis-log').innerHTML = `<strong>[ENGINE LOG]</strong><br>â€¢ ì§€ì—­ ìƒìƒ ì§€ìˆ˜(L): ${data.log.L} (ë¶„ì‚°ë²• ì ìš©)<br>â€¢ ê³„í†µ ì•ˆì •ì„±(G): 0.88<br>â€¢ íƒ„ì†Œ ê°€ì¹˜(C): ${data.log.C}`;
    }
    setLang('ko');
</script>
</body>
</html>